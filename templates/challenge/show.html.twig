{% extends 'base.html.twig' %}

{% block title %}Challenge{% endblock %}

{% block body %}
    
    <div class="page-heading normal-space">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
    {%for message in app.flashes('warning')%}
      <div class="alert alert-warning">
        {{ message }}</i>
      </div>
    {% endfor %}
    {%for message in app.flashes('success')%}
      <div class="alert alert-success">
        {{ message }}
      </div>
    {% endfor %}
          <h6><span>{{ challenge.DateC ? challenge.DateC|date('d M Y') : '' }}</span></h6>
          <h2>{{ challenge.Title }}</h2>
          <img src={{ asset('http://localhost/img/'~challenge.PathIMG) }} alt="" style="border-radius: 20px; max-width: 200px;" height=200>
          <h6>{{ challenge.Description }}</h6>
          <span>Level : {{ challenge.Niveau }}</span>
          <div class="buttons">
            <div class="main-button">
              <a>Participate</a>
            </div>
            <div class="border-button">
              <a href="create.html">Show Participations</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

{{ form_start(form,{'attr': {'novalidate': 'novalidate'}} ) }}
  <div class="item-details-page">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="section-heading">
            <div class="line-dec"></div>
            <h2>Apply For <em>Your Participation</em> Here.</h2>
          </div>
        </div>
        <div class="col-lg-12">

            <div class="row" style="color:white; margin-top:20px">
              <div class="col-lg-12">
                <fieldset>
                  <label style="color:white;" for={{form.Description.vars.id}}>Description</label>
                  <input style="width: 100%; background:transparent; border-color:#7453FC; border-radius: 25px; padding:5px;color:white;border-width: 10px; margin-top:5px;" type="title" value="{{form.Description.vars.value}}" name={{form.Description.vars.full_name}} id={{form.Description.vars.id}} placeholder="Ex. Lyon King" autocomplete="on" required>
                  {% do form.Description.setRendered %}
                </fieldset>
              </div>

              <div class="col-lg-4" style="margin-top:20px">
                <fieldset>
                  <label style="color:white;" for={{form.Image.vars.id}}>Your Image</label>
                  <input style="background-color:#7453FC; cursor:pointer;border-color:#7453FC; border-radius: 20px; padding:10px; padding-left:20px; color:white;border-width: 10px; width:100%; height:100%; margin-top:5px" type="file" id={{form.Image.vars.id}} name={{form.Image.vars.full_name}} />
                  {% do form.Image.setRendered %}
                </fieldset>
              </div>

              <div class="col-lg-12" style="margin-top:20px">
                <fieldset style="display:flex; justify-content:center;">
                  <button type="submit" id="form" class="orange-button">Submit Your Applying</button>
                </fieldset>
              </div>
              
            </div>

        </div>
        {{ form_end(form) }}

         <div class="col-lg-12">
          <div class="current-bid">
            <div class="row">
              <div class="col-lg-6">
                <div class="section-heading">
                  <h2>This Is The List Of <em>Participations</em></h2>  
                </div>              </div>
              <div class="col-lg-6">
                <fieldset>
                  <select name="Category" class="form-select" aria-label="Default select example" id="chooseCategory" onchange="this.form.click()">
                      <option selected>Sort By: Latest</option>
                      <option type="checkbox" name="option1" value="old">Sort By: Oldest</option>
                      <option value="low">Sort By: Lowest</option>
                      <option value="high">Sort By: Highest</option>
                  </select>
              </fieldset>
              </div>
        {% for p in challenge.participations %}

                    {% set k = 0 %}      
                    {% for r in challenge.ratings %}
                      {% if r.getParticipatorId().getid_user() == p.getIdUser().getid_user() and r.getRaterId().getid_user() == 1 %}
                        {% set k = r.getRating() %}
                      {% endif %}
                    {% endfor %}

              <div class="col-lg-4 col-md-6">
                <div class="item">
                  <div class="left-img">
                    <img src="{{ asset('http://localhost/img/'~p.getIMGParticipation()) }}" alt="">
                  </div>
                  <div class="right-content">
                    <h6>{{ p.getIdUser().getName()|capitalize }} {{ p.getIdUser().getLastName()|capitalize }}</h6>
                    <a href="#">@{{ p.getIdUser().getEmail() }}</a>
                    <div class="line-dec"></div>
                    <h6>Rating: <em>{{k|round}} Stars</em></h6>
                    <a class="border-button" href="{{path('app_participation_show',{'id_participation': p.getId() })}}"> Show </a>
                  </div>
                </div>
              </div>

        {%else%}
          <p> no Participation Yet </p>
        {%endfor%}
                          </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

      </div>
    </div>
  </div>

{% endblock %}
